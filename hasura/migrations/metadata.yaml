version: 2
tables:
- table:
    schema: public
    name: designations
  is_enum: true
- table:
    schema: public
    name: employees
  object_relationships:
  - name: designation
    using:
      foreign_key_constraint_on: designation_id
  - name: organization
    using:
      foreign_key_constraint_on: organization_id
  insert_permissions:
  - role: app_admin
    permission:
      check: {}
      columns:
      - designation_id
      - ecode
      - email
      - headshot
      - joining_date
      - name
      - organization_id
      - relieving_date
      backend_only: false
  select_permissions:
  - role: app_admin
    permission:
      columns:
      - joining_date
      - relieving_date
      - designation_id
      - ecode
      - email
      - headshot
      - name
      - created_at
      - updated_at
      - organization_id
      - user_id
      filter: {}
  - role: user
    permission:
      columns:
      - created_at
      - designation_id
      - ecode
      - email
      - headshot
      - joining_date
      - name
      - organization_id
      - relieving_date
      - updated_at
      - user_id
      filter:
        user_id:
          _eq: X-Hasura-User-Id
  update_permissions:
  - role: app_admin
    permission:
      columns:
      - designation_id
      - ecode
      - email
      - headshot
      - joining_date
      - name
      - organization_id
      - relieving_date
      filter: {}
      check: null
  delete_permissions:
  - role: app_admin
    permission:
      filter: {}
  event_triggers:
  - name: create_user_for_new_employee
    definition:
      enable_manual: false
      insert:
        columns: '*'
    retry_conf:
      num_retries: 0
      interval_sec: 10
      timeout_sec: 60
    webhook_from_env: NEW_EMPLOYEE_WEBHOOK
- table:
    schema: public
    name: organizations
  array_relationships:
  - name: employees
    using:
      foreign_key_constraint_on:
        column: organization_id
        table:
          schema: public
          name: employees
  - name: projects
    using:
      foreign_key_constraint_on:
        column: organization_id
        table:
          schema: public
          name: projects
  insert_permissions:
  - role: app_admin
    permission:
      check: {}
      columns:
      - logo
      - logo_square
      - name
      backend_only: false
  select_permissions:
  - role: app_admin
    permission:
      columns:
      - logo
      - logo_square
      - name
      - id
      filter: {}
  - role: user
    permission:
      columns:
      - id
      - name
      - logo
      - logo_square
      filter:
        employees:
          user_id:
            _eq: X-Hasura-User-Id
  update_permissions:
  - role: app_admin
    permission:
      columns:
      - logo
      - logo_square
      - name
      filter: {}
      check: {}
- table:
    schema: public
    name: projects
  object_relationships:
  - name: organization
    using:
      foreign_key_constraint_on: organization_id
  insert_permissions:
  - role: app_admin
    permission:
      check: {}
      columns:
      - description
      - issue_link_template
      - logo
      - logo_square
      - name
      - organization_id
      - pr_link_template
      backend_only: false
  select_permissions:
  - role: app_admin
    permission:
      columns:
      - description
      - issue_link_template
      - logo
      - logo_square
      - name
      - pr_link_template
      - created_at
      - updated_at
      - id
      - organization_id
      filter: {}
  update_permissions:
  - role: app_admin
    permission:
      columns:
      - description
      - issue_link_template
      - logo
      - logo_square
      - name
      - organization_id
      - pr_link_template
      filter: {}
      check: null
  delete_permissions:
  - role: app_admin
    permission:
      filter: {}
- table:
    schema: public
    name: roles
  is_enum: true
  select_permissions:
  - role: app_admin
    permission:
      columns:
      - id
      - name
      filter: {}
  - role: user
    permission:
      columns:
      - id
      - name
      filter: {}
- table:
    schema: public
    name: teams
  object_relationships:
  - name: project
    using:
      foreign_key_constraint_on: project_id
  insert_permissions:
  - role: app_admin
    permission:
      check: {}
      columns:
      - issue_link_template
      - logo
      - logo_square
      - name
      - pr_link_template
      - project_id
      backend_only: false
  select_permissions:
  - role: app_admin
    permission:
      columns:
      - issue_link_template
      - logo
      - logo_square
      - name
      - pr_link_template
      - created_at
      - updated_at
      - id
      - project_id
      filter: {}
  update_permissions:
  - role: app_admin
    permission:
      columns:
      - issue_link_template
      - logo
      - logo_square
      - name
      - pr_link_template
      - project_id
      filter: {}
      check: {}
  delete_permissions:
  - role: app_admin
    permission:
      filter: {}
- table:
    schema: public
    name: user_logins
- table:
    schema: public
    name: users
  object_relationships:
  - name: role
    using:
      foreign_key_constraint_on: role_id
  array_relationships:
  - name: as_employee
    using:
      foreign_key_constraint_on:
        column: user_id
        table:
          schema: public
          name: employees
  select_permissions:
  - role: app_admin
    permission:
      columns:
      - id
      - name
      - avatar
      - email
      - created_by
      - created_at
      - updated_at
      - role_id
      filter: {}
  - role: user
    permission:
      columns:
      - avatar
      - created_at
      - email
      - id
      - name
      - role_id
      - updated_at
      filter:
        id:
          _eq: X-Hasura-User-Id
      limit: 1
  event_triggers:
  - name: default_user_login
    definition:
      enable_manual: false
      insert:
        columns: '*'
    retry_conf:
      num_retries: 0
      interval_sec: 10
      timeout_sec: 60
    webhook_from_env: NEW_USER_WEBHOOK
